<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Empresa - Página Principal</title>
  <link rel="icon" href="img/logo.png" type="image/png">
  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- Font Awesome for icons -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  />
  <!-- Leaflet CSS for Map -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <style>
    body {
      padding-top: 70px; /* espacio para navbar fijo */
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .section-title {
      text-align: center;
      margin-bottom: 2rem;
      position: relative;
    }
    .section-title::after {
      content: '';
      display: block;
      width: 60px;
      height: 3px;
      background-color: #0d6efd; /* Bootstrap primary */
      margin: 10px auto 0;
      border-radius: 2px;
    }
    .card-img-top {
      height: 200px;
      object-fit: cover;
    }
    #map {
      height: 400px;
      width: 100%;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 2rem;
    }
    footer {
      background-color: #f8f9fa;
      padding: 1rem 0;
      text-align: center;
      font-size: 0.9rem;
      color: #6c757d;
    }
    .mobile-indicator {
      background-color: #ffc107;
      color: #000;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.8rem;
      font-weight: bold;
    }
    .card.active {
      border-color: #0d6efd;
      box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
    }
    .leaflet-popup-content-wrapper {
      background: #fff;
      border-radius: 6px;
    }
    .leaflet-popup-content {
      margin: 10px;
    }
    .distance-info {
      background: #e7f3ff;
      padding: 10px;
      border-radius: 6px;
      margin-top: 10px;
      font-size: 0.9rem;
    }
    .leaflet-marker-icon {
      border: 2px solid transparent;
    }
    .leaflet-marker-icon.active {
      border-color: #0d6efd;
      box-shadow: 0 0 0 2px rgba(13, 110, 253, 0.5);
    }
    .map-loading {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      flex-direction: column;
    }
    .fallback-map {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      height: 100%;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      flex-direction: column;
      text-decoration: none;
    }
    .fallback-map:hover {
      color: white;
      text-decoration: none;
      opacity: 0.9;
    }
    .carousel-image {
      height: 500px; /* Carrusel más grande */
      object-fit: cover;
    }
    .navbar-brand img {
      max-height: 40px;
    }
    .carousel-caption {
      background: rgba(0,0,0,0.6);
      border-radius: 10px;
      padding: 20px;
    }
    .carousel-control-prev,
    .carousel-control-next {
      width: 5%;
    }
  </style>
</head>
<body>
  <!-- Header / Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="#">
        <img
          src="img/logo.png"
          alt="Logotipo de la empresa"
          height="40"
        />
      </a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarContent"
        aria-controls="navbarContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarContent">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-center">
          <li class="nav-item">
            <a class="nav-link" href="#contact">Contacto</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#branches">Sucursales</a>
          </li>
          <li class="nav-item ms-3">
            <button
              class="btn btn-outline-primary"
              data-bs-toggle="modal"
              data-bs-target="#loginModal"
            >
              Iniciar Sesión
            </button>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Modal Login -->
  <div
    class="modal fade"
    id="loginModal"
    tabindex="-1"
    aria-labelledby="loginModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="loginForm" novalidate>
          <div class="modal-header">
            <h5 class="modal-title" id="loginModalLabel">Iniciar Sesión</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Cerrar"
            ></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="loginEmail" class="form-label">Email</label>
              <input
                type="email"
                class="form-control"
                id="loginEmail"
                required
                placeholder="tu@email.com"
              />
              <div class="invalid-feedback">Por favor ingresa un email válido.</div>
            </div>
            <div class="mb-3">
              <label for="loginPassword" class="form-label">Contraseña</label>
              <input
                type="password"
                class="form-control"
                id="loginPassword"
                required
                placeholder="Contraseña"
              />
              <div class="invalid-feedback">Por favor ingresa tu contraseña.</div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary w-100">Ingresar</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Slider de Promociones -->
  <section class="py-5">
    <div class="container">
      <h2 class="section-title">Promociones Especiales</h2>
      <div
        id="promoCarousel"
        class="carousel slide"
        data-bs-ride="carousel"
        data-bs-interval="4000"
      >
        <div class="carousel-indicators">
          <button
            type="button"
            data-bs-target="#promoCarousel"
            data-bs-slide-to="0"
            class="active"
            aria-current="true"
            aria-label="Promoción 1"
          ></button>
          <button
            type="button"
            data-bs-target="#promoCarousel"
            data-bs-slide-to="1"
            aria-label="Promoción 2"
          ></button>
          <button
            type="button"
            data-bs-target="#promoCarousel"
            data-bs-slide-to="2"
            aria-label="Promoción 3"
          ></button>
          <button
            type="button"
            data-bs-target="#promoCarousel"
            data-bs-slide-to="3"
            aria-label="Promoción 4"
          ></button>
          <button
            type="button"
            data-bs-target="#promoCarousel"
            data-bs-slide-to="4"
            aria-label="Promoción 5"
          ></button>
          <button
            type="button"
            data-bs-target="#promoCarousel"
            data-bs-slide-to="5"
            aria-label="Promoción 6"
          ></button>
          <button
            type="button"
            data-bs-target="#promoCarousel"
            data-bs-slide-to="6"
            aria-label="Promoción 7"
          ></button>
          <button
            type="button"
            data-bs-target="#promoCarousel"
            data-bs-slide-to="7"
            aria-label="Promoción 8"
          ></button>
        </div>
        <div class="carousel-inner rounded-3 shadow-sm">
          <div class="carousel-item active">
            <img
              src="img/1.jpg"
              class="d-block w-100 carousel-image"
              alt="Promoción especial 1 - Ofertas exclusivas"
            />
            <div class="carousel-caption d-none d-md-block rounded p-3">
              <h3>Oferta Especial 1</h3>
              <p>Descuentos increíbles en productos seleccionados</p>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="img/2.jpg"
              class="d-block w-100 carousel-image"
              alt="Promoción especial 2 - Productos destacados"
            />
            <div class="carousel-caption d-none d-md-block rounded p-3">
              <h3>Oferta Especial 2</h3>
              <p>Los mejores productos con descuentos limitados</p>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="img/3.jpg"
              class="d-block w-100 carousel-image"
              alt="Promoción especial 3 - Ofertas de temporada"
            />
            <div class="carousel-caption d-none d-md-block rounded p-3">
              <h3>Oferta Especial 3</h3>
              <p>Aprovecha nuestras ofertas de temporada</p>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="img/4.jpg"
              class="d-block w-100 carousel-image"
              alt="Promoción especial 4 - Descuentos exclusivos"
            />
            <div class="carousel-caption d-none d-md-block rounded p-3">
              <h3>Oferta Especial 4</h3>
              <p>Descuentos exclusivos para clientes frecuentes</p>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="img/5.jpg"
              class="d-block w-100 carousel-image"
              alt="Promoción especial 5 - Lanzamientos nuevos"
            />
            <div class="carousel-caption d-none d-md-block rounded p-3">
              <h3>Oferta Especial 5</h3>
              <p>Nuevos lanzamientos con precios especiales</p>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="img/6.jpg"
              class="d-block w-100 carousel-image"
              alt="Promoción especial 6 - Ofertas flash"
            />
            <div class="carousel-caption d-none d-md-block rounded p-3">
              <h3>Oferta Especial 6</h3>
              <p>Ofertas flash por tiempo limitado</p>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="img/7.jpg"
              class="d-block w-100 carousel-image"
              alt="Promoción especial 7 - Productos premium"
            />
            <div class="carousel-caption d-none d-md-block rounded p-3">
              <h3>Oferta Especial 7</h3>
              <p>Productos premium con descuentos especiales</p>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="img/8.jpg"
              class="d-block w-100 carousel-image"
              alt="Promoción especial 8 - Ofertas finales"
            />
            <div class="carousel-caption d-none d-md-block rounded p-3">
              <h3>Oferta Especial 8</h3>
              <p>Últimas oportunidades con descuentos increíbles</p>
            </div>
          </div>
        </div>
        <button
          class="carousel-control-prev"
          type="button"
          data-bs-target="#promoCarousel"
          data-bs-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Anterior</span>
        </button>
        <button
          class="carousel-control-next"
          type="button"
          data-bs-target="#promoCarousel"
          data-bs-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Siguiente</span>
        </button>
      </div>
    </div>
  </section>

  <!-- Sección Sucursales con Mapa -->
  <section id="branches" class="py-5 bg-light">
    <div class="container">
      <h2 class="section-title">Nuestras Sucursales</h2>
      <p class="text-center text-muted mb-4">Dos de nuestras sucursales son móviles y rotan sus posiciones para mejor cobertura. Verifica su ubicación actual en el mapa. Cada sucursal cubre un radio de 20km.</p>
      
      <!-- Mapa Interactivo -->
      <div id="map">
        <div class="map-loading">
          <div class="spinner-border text-primary mb-3" role="status">
            <span class="visually-hidden">Cargando mapa...</span>
          </div>
          <p>Cargando mapa interactivo...</p>
        </div>
      </div>
      <div id="distanceInfo" class="distance-info" style="display: none;"></div>
      
      <div class="row g-4 mt-4">
        <div class="col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm" id="card-centro">
            <img
              src="img/logo.png"
              class="card-img-top"
              alt="Sucursal centro con fachada moderna y amplio estacionamiento"
            />
            <div class="card-body">
              <h5 class="card-title">Sucursal Centro <span class="mobile-indicator">Fija</span></h5>
              <p class="card-text" id="centro-address">Av. Corrientes 123, CABA (Lat: -34.6037, Lng: -58.3816)</p>
              <p class="mb-0">
                <small class="text-muted"
                  ><i class="fas fa-clock me-2"></i>Lunes a Sábado 9:00 - 20:00</small
                >
              </p>
              <p>
                <small class="text-muted"
                  ><i class="fas fa-phone me-2"></i>(11) 456-7890</small
                >
              </p>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm" id="card-norte">
            <img
              src="img/logo.png"
              class="card-img-top"
              alt="Sucursal norte móvil en vehículo con equipamiento completo"
            />
            <div class="card-body">
              <h5 class="card-title">Sucursal Norte <span class="mobile-indicator">Móvil</span></h5>
              <p class="card-text" id="norte-address">Posición actual: Actualizándose... (Lat/Lng: Actualizándose...)</p>
              <p class="mb-0">
                <small class="text-muted"
                  ><i class="fas fa-clock me-2"></i>Lunes a Domingo 10:00 - 22:00</small
                >
              </p>
              <p>
                <small class="text-muted"
                  ><i class="fas fa-phone me-2"></i>(11) 456-7891</small
                >
              </p>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm" id="card-sur">
            <img
              src="img/logo.png"
              class="card-img-top"
              alt="Sucursal sur móvil tipo pop-up con atención personalizada"
            />
            <div class="card-body">
              <h5 class="card-title">Sucursal Sur <span class="mobile-indicator">Móvil</span></h5>
              <p class="card-text" id="sur-address">Posición actual: Actualizándose... (Lat/Lng: Actualizándose...)</p>
              <p class="mb-0">
                <small class="text-muted"
                  ><i class="fas fa-clock me-2"></i>Lunes a Viernes 8:00 - 18:00</small
                >
              </p>
              <p>
                <small class="text-muted"
                  ><i class="fas fa-phone me-2"></i>(11) 456-7892</small
                >
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Sección Contacto y Formulario de Quejas -->
  <section id="contact" class="py-5">
    <div class="container">
      <h2 class="section-title">Contacto</h2>
      <div class="row g-5">
        <!-- Información de contacto -->
        <div class="col-lg-5">
          <h5>Dirección Corporativa</h5>
          <p>Av. Central #1000, CABA</p>
          <h5>Teléfono</h5>
          <p>(11) 456-7800</p>
          <h5>Email</h5>
          <p>info@empresa.com</p>
          <h5>Horario de Atención</h5>
          <p>
            Lunes a Viernes: 8:00 - 18:00<br />
            Sábados: 9:00 - 14:00
          </p>
        </div>

        <!-- Formulario de Quejas -->
        <div class="col-lg-7">
          <h2 class="section-title">Formulario de Quejas y Sugerencias</h2>
          <form id="complaintForm" novalidate>
            <div class="mb-3">
              <label for="email" class="form-label">Email</label>
              <input
                type="email"
                class="form-control"
                id="email"
                placeholder="tu@email.com"
                required
              />
              <div class="invalid-feedback">Por favor ingresa un email válido.</div>
            </div>
            <div class="mb-3">
              <label for="subject" class="form-label">Asunto</label>
              <input
                type="text"
                class="form-control"
                id="subject"
                placeholder="Asunto de tu mensaje"
                required
              />
              <div class="invalid-feedback">Por favor ingresa el asunto.</div>
            </div>
            <div class="mb-3">
              <label for="branch" class="form-label">Sucursal</label>
              <select class="form-select" id="branch" required>
                <option value="" selected disabled>Selecciona una sucursal</option>
                <option value="centro">Sucursal Centro (Fija)</option>
                <option value="norte">Sucursal Norte (Móvil)</option>
                <option value="sur">Sucursal Sur (Móvil)</option>
                <option value="otra">Otra ubicación</option>
              </select>
              <div class="invalid-feedback">Por favor selecciona una sucursal.</div>
            </div>
            <div class="mb-3">
              <label for="description" class="form-label">Descripción</label>
              <textarea
                class="form-control"
                id="description"
                rows="5"
                placeholder="Describe tu queja o sugerencia..."
                required
              ></textarea>
              <div class="invalid-feedback">
                Por favor describe tu queja o sugerencia.
              </div>
            </div>
            <button type="submit" class="btn btn-primary w-100">
              Enviar Mensaje
            </button>
          </form>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <p>© 2024 Empresa. Todos los derechos reservados.</p>
    </div>
  </footer>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Leaflet JS for Map -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <!-- Script del Mapa Simplificado -->
  <script>
    // Coordenadas de Buenos Aires
    const branchLocations = {
      centro: { 
        lat: -34.6037, 
        lng: -58.3816, 
        name: "Sucursal Centro", 
        address: "Av. Corrientes 123, CABA",
        mobile: false 
      },
      norte: { 
        lat: -34.5458, 
        lng: -58.4671, 
        name: "Sucursal Norte", 
        address: "Zona Norte, Buenos Aires",
        mobile: true 
      },
      sur: { 
        lat: -34.6355, 
        lng: -58.4156, 
        name: "Sucursal Sur", 
        address: "Zona Sur, Buenos Aires", 
        mobile: true 
      }
    };

    let map;
    let markers = [];

    function initMap() {
      const mapContainer = document.getElementById('map');
      
      // Mostrar estado de carga
      mapContainer.innerHTML = `
        <div class="map-loading">
          <div class="spinner-border text-primary mb-3" role="status">
            <span class="visually-hidden">Cargando mapa...</span>
          </div>
          <p>Cargando mapa interactivo...</p>
        </div>
      `;

      // Cargar Leaflet con timeout de seguridad
      const loadMap = setTimeout(() => {
        try {
          // Verificar si Leaflet está disponible
          if (typeof L === 'undefined') {
            throw new Error('Leaflet no se cargó correctamente');
          }

          // Crear el mapa centrado en Buenos Aires
          map = L.map('map').setView([-34.6037, -58.3816], 11);

          // Capa de tiles de OpenStreetMap
          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors',
            maxZoom: 18
          }).addTo(map);

          // Agregar marcadores
          addBranchMarkers();
          
        } catch (error) {
          console.error('Error cargando el mapa:', error);
          showFallbackMap();
        }
      }, 100);

      // Fallback si Leaflet no carga en 5 segundos
      setTimeout(() => {
        if (!map) {
          clearTimeout(loadMap);
          showFallbackMap();
        }
      }, 5000);
    }

    function addBranchMarkers() {
      Object.keys(branchLocations).forEach(branchKey => {
        const branch = branchLocations[branchKey];
        
        // Crear icono personalizado
        const iconHtml = branch.mobile ? 
          '<div style="background-color: #dc3545; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-size: 12px; border: 2px solid white;"><i class="fas fa-truck"></i></div>' :
          '<div style="background-color: #198754; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-size: 12px; border: 2px solid white;"><i class="fas fa-store"></i></div>';

        const customIcon = L.divIcon({
          html: iconHtml,
          className: 'custom-marker',
          iconSize: [30, 30],
          iconAnchor: [15, 15]
        });

        const marker = L.marker([branch.lat, branch.lng], { icon: customIcon })
          .addTo(map)
          .bindPopup(`
            <div class="text-center">
              <h6>${branch.name}</h6>
              <p class="mb-1">${branch.address}</p>
              <small class="text-muted">${branch.mobile ? 'Sucursal Móvil' : 'Sucursal Fija'}</small>
            </div>
          `);

        markers.push(marker);

        // Actualizar información en las tarjetas
        updateBranchCard(branchKey, branch);
      });
    }

    function updateBranchCard(branchKey, branch) {
      const card = document.getElementById(`card-${branchKey}`);
      const addressElement = document.getElementById(`${branchKey}-address`);
      
      if (addressElement) {
        if (branch.mobile) {
          addressElement.textContent = `Posición actual: ${branch.address} (Lat: ${branch.lat.toFixed(4)}, Lng: ${branch.lng.toFixed(4)})`;
        } else {
          addressElement.textContent = `${branch.address} (Lat: ${branch.lat.toFixed(4)}, Lng: ${branch.lng.toFixed(4)})`;
        }
      }
    }

    function showFallbackMap() {
      const mapContainer = document.getElementById('map');
      mapContainer.innerHTML = `
        <a href="https://www.google.com/maps/search/sucursales/@-34.6037,-58.3816,11z" target="_blank" class="fallback-map">
          <i class="fas fa-map-marked-alt fa-3x mb-3"></i>
          <h4>Ver nuestras sucursales en Google Maps</h4>
          <p class="mb-0">Haz clic para abrir el mapa</p>
          <div class="mt-3">
            <p><strong>Sucursal Centro:</strong> Av. Corrientes 123, CABA</p>
            <p><strong>Sucursal Norte:</strong> Zona Norte, Buenos Aires (Móvil)</p>
            <p><strong>Sucursal Sur:</strong> Zona Sur, Buenos Aires (Móvil)</p>
          </div>
        </a>
      `;
    }

    // Inicializar el mapa cuando la página cargue
    document.addEventListener('DOMContentLoaded', function() {
      initMap();
      
      // Manejo de formularios
      const loginForm = document.getElementById('loginForm');
      if (loginForm) {
        loginForm.addEventListener('submit', function(event) {
          if (!loginForm.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          loginForm.classList.add('was-validated');
        });
      }
      
      const complaintForm = document.getElementById('complaintForm');
      if (complaintForm) {
        complaintForm.addEventListener('submit', function(event) {
          if (!complaintForm.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          complaintForm.classList.add('was-validated');
        });
      }
    });

    // También intentar cargar cuando la sección sea visible
    document.addEventListener('visibilitychange', function() {
      if (!document.hidden && !map) {
        initMap();
      }
    });
  </script>
</body>
</html>